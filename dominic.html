<!DOCTYPE html>
<html>
<head>
  <title>Dashboard</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h2>Dashboard</h2>
<div style="margin-bottom:20px;">
  <button onclick="goTeamDashboard()" style="padding:8px 12px; margin-right:10px;">Team Dashboard</button>
  <button onclick="logout()" style="padding:8px 12px;">Logout</button>
</div>

<script>
function goTeamDashboard(){
  window.location.href = "team-dashboard.html";
}

function logout(){
  localStorage.removeItem("loggedInUser");
  window.location.href = "index.html";
}
</script>


<h3>My Tasks</h3>
<div id="tasks"></div>

<h3>Submit Work</h3>
<input id="submission" placeholder="Paste work or file name">
<button onclick="submitTask()">Submit</button>

<script>
let user = "dominic"; // change to anne or mary for their page
let tasks = JSON.parse(localStorage.getItem("tasks") || "[]");

function loadTasks(){
  const box = document.getElementById("tasks");
  box.innerHTML = "";

  tasks.forEach((t,index)=>{
    if(t.person === user){
      // Color badges
      let statusColor = t.status === "Done" ? "#4CAF50" :
                        t.status === "Submitted" ? "#FFC107" : "#2196F3";
      let priorityColor = t.priority === "High" ? "#FF4C4C" :
                          t.priority === "Medium" ? "#FFB74D" : "#81C784";

      box.innerHTML += `
        <div class="task-card">
          <div>
            <p><strong>${t.title}</strong></p>
            <p>Deadline: ${t.deadline}</p>
            <p>Priority: <span style="color:${priorityColor}">${t.priority}</span></p>
            <p>Status: <span style="color:${statusColor}">${t.status}</span></p>
            <p>Created: ${t.createdAt}</p>
            <p>Submission: ${t.submission || "Not submitted"}</p>
          </div>
          <div>
            ${t.status !== "Done" ? `<button onclick="markDone(${index})">Mark Done</button>` : ""}
          </div>
        </div>
      `;
    }
  });
}

// Mark done
function markDone(index){
  tasks[index].status = "Done";
  localStorage.setItem("tasks", JSON.stringify(tasks));
  loadTasks();
}

// Submit task
function submitTask(){
  const sub = document.getElementById("submission").value;
  if(!sub){
    alert("Enter work to submit");
    return;
  }

  // Find first assigned or submitted task
  const taskIndex = tasks.findIndex(t => t.person === user && t.status !== "Done");
  if(taskIndex !== -1){
    tasks[taskIndex].submission = sub;
    tasks[taskIndex].status = "Submitted";
    localStorage.setItem("tasks", JSON.stringify(tasks));
    loadTasks();
    document.getElementById("submission").value = "";
    alert("Work submitted!");
  } else {
    alert("No tasks available for submission");
  }
}

// Initial load
loadTasks();
</script>

</body>
</html>
